<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0PEL3G7HEM"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-0PEL3G7HEM');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opendoor Stock Tracker | $OPEN Real-Time Sales Intelligence Dashboard</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Track Opendoor ($OPEN) real-time home sales, revenue, win rates, and Q1 2026 guidance pacing. Live data from 700+ sales showing daily velocity, P&L metrics, and market trends.">
    <meta name="keywords" content="Opendoor, OPEN stock, Opendoor tracker, Opendoor sales, iBuyer analytics, real estate stock, Opendoor revenue, home sales tracker">
    <meta name="author" content="Glass House Analytics">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://opendoor-tracker.com/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://opendoor-tracker.com/">
    <meta property="og:title" content="Opendoor Stock Tracker | $OPEN Real-Time Sales Dashboard">
    <meta property="og:description" content="Track Opendoor ($OPEN) real-time home sales, revenue, and Q1 guidance pacing. Live data from 700+ sales with daily velocity and P&L metrics.">
    <meta property="og:image" content="https://opendoor-tracker.com/og-image.png">
    <meta property="og:site_name" content="Opendoor Tracker">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://opendoor-tracker.com/">
    <meta name="twitter:title" content="Opendoor Stock Tracker | $OPEN Real-Time Sales Dashboard">
    <meta name="twitter:description" content="Track Opendoor ($OPEN) real-time home sales, revenue, and Q1 guidance pacing. Live data from 700+ sales.">
    <meta name="twitter:image" content="https://opendoor-tracker.com/og-image.png">

    <!-- Additional SEO -->
    <meta name="theme-color" content="#22c55e">
    <meta name="apple-mobile-web-app-title" content="OPEN Tracker">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --green: #22c55e;
            --green-dim: rgba(34, 197, 94, 0.1);
            --amber: #f59e0b;
            --amber-dim: rgba(245, 158, 11, 0.1);
            --red: #ef4444;
            --red-dim: rgba(239, 68, 68, 0.1);
            --text: #ffffff;
            --text-2: #a0a0a0;
            --text-3: #666666;
            --text-4: #333333;
            --border: #1a1a1a;
            --surface: #0a0a0a;
            --card: #141414;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: #000;
            color: var(--text);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        /* ============================================================
           HEADER
           ============================================================ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
            margin-bottom: 32px;
            border-bottom: 1px solid var(--border);
        }

        .header__brand {
            font-size: 15px;
            font-weight: 600;
            color: var(--text);
        }

        .header__right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header__ticker {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--text-2);
            background: var(--surface);
            padding: 4px 10px;
            border-radius: 4px;
        }

        .header__timestamp {
            font-size: 12px;
            color: var(--text-3);
        }

        .header__refresh-note {
            font-size: 10px;
            color: var(--text-3);
            opacity: 0.7;
        }

        .header__btn {
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-2);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .header__btn:hover {
            background: #1a1a1a;
            color: var(--text);
        }

        /* ============================================================
           THE VERDICT (Top Hero Section)
           ============================================================ */
        .verdict {
            background: var(--surface);
            border-left: 3px solid var(--green);
            border-radius: 8px;
            padding: 24px 28px;
            margin-bottom: 40px;
        }

        .verdict__headline {
            font-size: 20px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .verdict__body {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-2);
            margin-bottom: 16px;
        }

        .verdict__warning {
            font-size: 13px;
            color: var(--amber);
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        /* ============================================================
           RATE WATCH BAR
           ============================================================ */
        .rate-watch {
            background: var(--surface);
            border-radius: 8px;
            padding: 16px 24px;
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            gap: 0;
        }

        .rate-watch__item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            flex: 1;
            padding: 0 16px;
            border-right: 1px solid var(--border);
        }

        .rate-watch__item:last-child {
            border-right: none;
        }

        .rate-watch__label {
            font-size: 10px;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .rate-watch__value {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-1);
            font-family: 'JetBrains Mono', monospace;
        }

        .rate-watch__sub {
            font-size: 11px;
            color: var(--text-3);
            font-family: 'JetBrains Mono', monospace;
        }

        .rate-watch__sub.down { color: var(--green); }
        .rate-watch__sub.up { color: var(--red); }

        .rate-watch__status {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .rate-watch__status.hold { background: rgba(245, 158, 11, 0.15); color: var(--amber); }
        .rate-watch__status.cut { background: rgba(16, 185, 129, 0.15); color: var(--green); }
        .rate-watch__status.hike { background: rgba(239, 68, 68, 0.15); color: var(--red); }

        .rate-watch__source {
            font-size: 9px;
            color: var(--text-3);
            opacity: 0.7;
            margin-top: 2px;
        }

        @media (max-width: 600px) {
            .rate-watch {
                flex-wrap: wrap;
                gap: 12px;
            }
            .rate-watch__item {
                flex: 0 0 45%;
                border-right: none;
                padding: 8px;
                background: rgba(255,255,255,0.02);
                border-radius: 6px;
            }
        }

        .rate-watch__status.hold { background: rgba(245, 158, 11, 0.15); color: var(--amber); }
        .rate-watch__status.cut { background: rgba(16, 185, 129, 0.15); color: var(--green); }
        .rate-watch__status.hike { background: rgba(239, 68, 68, 0.15); color: var(--red); }

        /* ============================================================
           SECTION STYLES (V3)
           ============================================================ */
        .section {
            margin-bottom: 48px;
        }

        .section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        /* ============================================================
           SPLIT PANEL (V3)
           ============================================================ */
        .split {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .panel {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
        }

        .panel-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-2);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .big-num {
            font-family: 'JetBrains Mono', monospace;
            font-size: 36px;
            font-weight: 600;
            line-height: 1;
            margin-bottom: 4px;
        }

        .big-label {
            font-size: 13px;
            color: var(--text-3);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 13px;
            border-bottom: 1px solid #111;
        }

        .stat-row:last-child { border-bottom: none; }
        .stat-label { color: var(--text-2); }
        .stat-value { font-family: 'JetBrains Mono', monospace; }

        .green { color: var(--green); }
        .amber { color: var(--amber); }
        .red { color: var(--red); }

        /* ============================================================
           EXPOSURE BOX (V3)
           ============================================================ */
        .exposure {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            margin-top: 16px;
        }

        .exposure-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-3);
            margin-bottom: 12px;
        }

        .exposure-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .exposure-item { text-align: center; }

        .exposure-num {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 600;
        }

        .exposure-label {
            font-size: 11px;
            color: var(--text-3);
            margin-top: 4px;
        }

        /* ============================================================
           WATCHLIST (Inline in Kaz Section)
           ============================================================ */
        .watchlist {
            background: #0d0d0d;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px 20px;
            margin-top: 16px;
        }

        .watchlist-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 12px;
            color: var(--text-2);
        }

        .watchlist-header strong { color: var(--text); }

        .watchlist-table {
            width: 100%;
            font-size: 12px;
            border-collapse: collapse;
        }

        .watchlist-table th {
            text-align: left;
            padding: 6px 8px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-3);
            border-bottom: 1px solid var(--border);
        }

        .watchlist-table td {
            padding: 8px;
            border-bottom: 1px solid #111;
            font-family: 'JetBrains Mono', monospace;
        }

        .watchlist-table tr:last-child td { border-bottom: none; }
        .watchlist-table .name { font-family: 'Inter', sans-serif; }

        .status-badge {
            display: inline-block;
            font-size: 10px;
            font-weight: 500;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Inter', sans-serif;
        }

        .status-badge.concern { background: var(--amber-dim); color: var(--amber); }
        .status-badge.watching { background: rgba(102, 102, 102, 0.2); color: var(--text-2); }

        /* ============================================================
           TOXIC CLEARANCE SECTION
           ============================================================ */
        .toxic-clearance {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 48px;
        }

        .toxic-clearance__title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
            margin-bottom: 16px;
        }

        .toxic-clearance__labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .toxic-clearance__cleared { color: var(--green); font-weight: 600; }
        .toxic-clearance__remaining { color: var(--red); font-weight: 600; }

        .toxic-clearance__bar {
            position: relative;
            height: 20px;
            background: var(--text-4);
            border-radius: 10px;
            overflow: visible;
            margin-bottom: 16px;
        }

        .toxic-clearance__fill {
            height: 100%;
            background: linear-gradient(90deg, var(--green) 0%, #16a34a 100%);
            border-radius: 10px 0 0 10px;
            position: relative;
        }

        .toxic-clearance__marker {
            position: absolute;
            right: -2px;
            top: -3px;
            width: 4px;
            height: 26px;
            background: var(--text);
            border-radius: 2px;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }

        .toxic-clearance__projection {
            font-size: 13px;
            color: var(--text-2);
            margin-bottom: 12px;
        }

        .toxic-clearance__projection strong { color: var(--green); }

        .toxic-clearance__trend {
            display: flex;
            gap: 20px;
            font-size: 12px;
            color: var(--text-3);
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .toxic-clearance__trend span {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-2);
        }

        /* ============================================================
           ACQUISITION PIPELINE SECTION
           ============================================================ */
        .acquisition-section {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 48px;
        }

        .acquisition-section__title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
            margin-bottom: 16px;
        }

        .acquisition-metrics {
            display: flex;
            justify-content: center;
            gap: 48px;
            margin-bottom: 16px;
        }

        .acquisition-metric {
            text-align: center;
        }

        .acquisition-metric__value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            font-weight: 600;
            color: var(--green);
        }

        .acquisition-metric__value.amber { color: var(--amber); }

        .acquisition-metric__label {
            font-size: 11px;
            color: var(--text-3);
            margin-top: 4px;
        }

        .acquisition-metric__delta {
            font-size: 12px;
            margin-top: 2px;
        }

        .acquisition-metric__delta.up { color: var(--green); }
        .acquisition-metric__delta.down { color: var(--red); }

        .acquisition-trend {
            display: flex;
            justify-content: space-between;
            padding-top: 12px;
            border-top: 1px solid var(--border);
            font-size: 12px;
            color: var(--text-3);
        }

        .acquisition-trend__weeks {
            display: flex;
            gap: 8px;
            font-family: 'JetBrains Mono', monospace;
        }

        .acquisition-trend__week {
            color: var(--text-2);
        }

        /* ============================================================
           PRODUCT UPDATES SECTION
           ============================================================ */
        .product-updates {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 48px;
        }

        .product-updates__title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
            margin-bottom: 16px;
        }

        .product-updates__grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        @media (max-width: 600px) {
            .product-updates__grid {
                grid-template-columns: 1fr;
            }
        }

        .product-category {
            padding: 12px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 6px;
            border-left: 3px solid var(--green);
        }

        .product-category.ai { border-left-color: #8b5cf6; }
        .product-category.buyer { border-left-color: #06b6d4; }
        .product-category.seller { border-left-color: #22c55e; }
        .product-category.agent { border-left-color: #f59e0b; }
        .product-category.acquisitions { border-left-color: #ef4444; }

        .product-category__title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-2);
            margin-bottom: 8px;
        }

        .product-category__count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--text-3);
            margin-left: 4px;
        }

        .product-item {
            font-size: 12px;
            color: var(--text);
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
        }

        .product-item__name {
            flex: 1;
            line-height: 1.4;
        }

        .product-item__date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--text-3);
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* ============================================================
           CAREERS SECTION
           ============================================================ */
        .careers-section {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 48px;
        }

        .careers-section__title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
            margin-bottom: 16px;
        }

        .careers-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .careers-total {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .careers-total__number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 32px;
            font-weight: 600;
            color: var(--green);
        }

        .careers-total__label {
            font-size: 13px;
            color: var(--text-2);
        }

        .careers-signal {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .careers-signal.technology { background: rgba(139, 92, 246, 0.2); color: #a78bfa; }
        .careers-signal.growth { background: var(--green-dim); color: var(--green); }
        .careers-signal.balanced { background: var(--amber-dim); color: var(--amber); }

        .careers-departments {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        @media (max-width: 600px) {
            .careers-departments {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .careers-dept {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 6px;
            padding: 12px;
            text-align: center;
        }

        .careers-dept__count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 600;
            color: var(--text);
        }

        .careers-dept__name {
            font-size: 10px;
            color: var(--text-3);
            margin-top: 4px;
        }

        .careers-highlights {
            display: flex;
            gap: 16px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
            font-size: 12px;
            color: var(--text-3);
        }

        .careers-highlights span {
            color: var(--text-2);
            font-family: 'JetBrains Mono', monospace;
        }

        .careers-ai-insights {
            margin-top: 16px;
        }

        .careers-ai-insights__title {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-3);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .careers-ai-insights__title::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            background: #a78bfa;
            border-radius: 50%;
        }

        .careers-insight {
            padding: 12px 14px;
            background: rgba(167, 139, 250, 0.06);
            border-left: 2px solid rgba(167, 139, 250, 0.4);
            border-radius: 0 6px 6px 0;
            margin-bottom: 10px;
            font-size: 13px;
            line-height: 1.5;
            color: var(--text-2);
        }

        .careers-insight:last-child {
            margin-bottom: 0;
        }

        /* ============================================================
           PROBLEM HOMES SECTION
           ============================================================ */
        .problem-homes-section {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 48px;
        }

        .problem-homes__title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
            margin-bottom: 16px;
        }

        .problem-homes__summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        @media (max-width: 600px) {
            .problem-homes__summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .problem-stat {
            text-align: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 6px;
        }

        .problem-stat__value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 24px;
            font-weight: 600;
        }

        .problem-stat__value.toxic { color: var(--red); }
        .problem-stat__value.stale { color: var(--amber); }
        .problem-stat__value.pnl { color: var(--red); }

        .problem-stat__label {
            font-size: 10px;
            color: var(--text-3);
            margin-top: 4px;
        }

        .problem-markets__title {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-3);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .problem-markets__title::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            background: var(--red);
            border-radius: 50%;
        }

        .problem-market {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 14px;
            background: rgba(239, 68, 68, 0.06);
            border-left: 3px solid;
            border-radius: 0 6px 6px 0;
            margin-bottom: 8px;
        }

        .problem-market.critical { border-color: var(--red); background: rgba(239, 68, 68, 0.08); }
        .problem-market.high { border-color: var(--amber); background: rgba(245, 158, 11, 0.06); }
        .problem-market.moderate { border-color: var(--text-3); background: rgba(255, 255, 255, 0.02); }

        .problem-market__info {
            flex: 1;
        }

        .problem-market__state {
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
        }

        .problem-market__stats {
            font-size: 12px;
            color: var(--text-3);
            margin-top: 2px;
        }

        .problem-market__stats span {
            color: var(--text-2);
            font-family: 'JetBrains Mono', monospace;
        }

        .problem-market__risk {
            text-align: right;
        }

        .problem-market__risk-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 18px;
            font-weight: 600;
        }

        .problem-market.critical .problem-market__risk-score { color: var(--red); }
        .problem-market.high .problem-market__risk-score { color: var(--amber); }

        .problem-market__risk-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-3);
        }

        .problem-market__links {
            margin-top: 6px;
        }

        .problem-market__link {
            font-size: 11px;
            color: var(--blue);
            text-decoration: none;
            margin-right: 12px;
        }

        .problem-market__link:hover {
            text-decoration: underline;
        }

        /* ============================================================
           VELOCITY / METRICS (V3)
           ============================================================ */
        .metrics-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .metric-card {
            background: var(--surface);
            border-radius: 6px;
            padding: 14px;
            text-align: center;
        }

        .metric-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 18px;
            font-weight: 600;
        }

        .metric-label {
            font-size: 10px;
            color: var(--text-3);
            margin-top: 4px;
            text-transform: uppercase;
        }

        .progress-bar {
            height: 6px;
            background: var(--text-4);
            border-radius: 3px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            border-radius: 3px;
        }

        /* ============================================================
           TABLES (V3)
           ============================================================ */
        .tbl {
            width: 100%;
            font-size: 13px;
            border-collapse: collapse;
        }

        .tbl th {
            text-align: left;
            padding: 10px 8px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-3);
            border-bottom: 1px solid var(--border);
        }

        .tbl td {
            padding: 12px 8px;
            border-bottom: 1px solid #111;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        .tbl tr:last-child td { border-bottom: none; }
        .tbl .name { font-family: 'Inter', sans-serif; font-weight: 500; }

        .insight-text {
            margin-top: 16px;
            font-size: 13px;
            color: var(--text-2);
        }

        /* Risk Indicators */
        .risk-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }

        .risk-dot.high { background: var(--red); }
        .risk-dot.medium {
            background: linear-gradient(90deg, var(--amber) 50%, transparent 50%);
            border: 2px solid var(--amber);
            box-sizing: border-box;
        }
        .risk-dot.low {
            background: transparent;
            border: 2px solid var(--text-3);
            box-sizing: border-box;
        }

        .risk-legend {
            display: flex;
            gap: 16px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
            font-size: 10px;
            color: var(--text-3);
        }

        .risk-legend span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* ============================================================
           CHART CONTAINER
           ============================================================ */
        .chart-container {
            background: var(--card);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        #revenue-chart {
            width: 100%;
            height: 260px;
        }

        #sales-price-chart {
            width: 100%;
            height: 260px;
        }

        /* ============================================================
           THIS WEEK SECTION
           ============================================================ */
        .this-week {
            background: var(--surface);
            border-radius: 8px;
            padding: 20px;
        }

        .this-week__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .this-week__title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-3);
        }

        .this-week__date {
            font-size: 11px;
            color: var(--text-3);
            background: #1a1a1a;
            padding: 4px 10px;
            border-radius: 4px;
        }

        .this-week__group {
            margin-bottom: 20px;
        }

        .this-week__group:last-child { margin-bottom: 0; }

        .this-week__group-label {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .this-week__group-label.improving { color: var(--green); }
        .this-week__group-label.stable { color: var(--text-3); }
        .this-week__group-label.watching { color: var(--amber); }

        .this-week__items {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .this-week__item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 13px;
            color: var(--text-2);
        }

        .this-week__icon {
            width: 16px;
            flex-shrink: 0;
            text-align: center;
        }

        .this-week__item.improving .this-week__icon { color: var(--green); }
        .this-week__item.stable .this-week__icon { color: var(--text-3); }
        .this-week__item.watching .this-week__icon { color: var(--amber); }

        /* ============================================================
           DISCLAIMER (V3)
           ============================================================ */
        .disclaimer {
            background: #0d0d0d;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            margin-top: 48px;
        }

        .disclaimer-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--amber);
            margin-bottom: 12px;
        }

        .disclaimer-text {
            font-size: 12px;
            color: var(--text-2);
            line-height: 1.6;
        }

        .disclaimer-text strong { color: var(--text); }

        /* ============================================================
           FOOTER (V3)
           ============================================================ */
        footer {
            text-align: center;
            padding: 40px 0 24px;
            border-top: 1px solid var(--border);
            margin-top: 48px;
        }

        .footer-brand { font-size: 14px; font-weight: 600; margin-bottom: 6px; }
        .footer-sub { font-size: 12px; color: var(--text-3); }

        /* ============================================================
           SCREENSHOT MODE
           ============================================================ */
        body.screenshot-mode .disclaimer,
        body.screenshot-mode footer {
            display: none !important;
        }

        body.screenshot-mode::after {
            content: 'Glass House';
            position: fixed;
            bottom: 16px;
            right: 20px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-3);
            opacity: 0.6;
        }

        /* ============================================================
           RESPONSIVE
           ============================================================ */
        @media (max-width: 600px) {
            .split { grid-template-columns: 1fr; }
            .metrics-row { grid-template-columns: repeat(2, 1fr); }
            .exposure-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
<div class="container">

    <!-- ============================================================
         HEADER
         ============================================================ -->
    <header class="header">
        <div class="header__brand">Glass House</div>
        <div class="header__right">
            <span class="header__ticker" id="stock-ticker">$OPEN --</span>
            <span class="header__timestamp" id="timestamp">Loading...</span>
            <span class="header__refresh-note">Fresh data daily at 12pm PT</span>
        </div>
    </header>

    <!-- ============================================================
         THE VERDICT
         ============================================================ -->
    <section class="verdict">
        <h1 class="verdict__headline">Q1 TRACKING AT <span data-metric="pacing">94.9%</span> OF GUIDANCE</h1>
        <p class="verdict__body">
            <strong><span data-metric="q1-sales">715</span> homes sold</strong> in Q1 so far, generating
            <strong><span data-metric="q1-revenue">$274.1M</span></strong> revenue.
            Running at <strong><span data-metric="daily-avg-sales">22.0</span> homes/day</strong> —
            need ~29/day to hit $1B guidance.
        </p>
        <p class="verdict__body">
            Win rate holding at <strong><span data-metric="win-rate">79.1%</span></strong> with
            <strong><span data-metric="avg-profit">$46,407</span></strong> avg profit per win.
            Total realized P&L: <strong class="green"><span data-metric="total-realized">$8.4M</span></strong>.
        </p>
        <p class="verdict__warning">
            &#9888; <span data-metric="days-remaining">64</span> days left in Q1.
            Velocity needs to increase ~32% to hit guidance.
        </p>
    </section>

    <!-- ============================================================
         RATE WATCH BAR
         ============================================================ -->
    <div class="rate-watch" id="rate-watch">
        <div class="rate-watch__item">
            <span class="rate-watch__label">30Y Mortgage</span>
            <span class="rate-watch__value" id="rate-30y">--</span>
            <span class="rate-watch__sub" id="rate-30y-change">--</span>
        </div>
        <div class="rate-watch__item">
            <span class="rate-watch__label">Fed Funds</span>
            <span class="rate-watch__value" id="fed-funds">--</span>
            <span class="rate-watch__status hold" id="fed-status">HOLD</span>
        </div>
        <div class="rate-watch__item">
            <span class="rate-watch__label">Next FOMC</span>
            <span class="rate-watch__value" id="next-fomc">--</span>
            <span class="rate-watch__sub">&nbsp;</span>
        </div>
        <div class="rate-watch__item">
            <span class="rate-watch__label">2026 Cuts</span>
            <span class="rate-watch__value" id="polymarket-cuts">--</span>
            <span class="rate-watch__sub" id="polymarket-pct">--</span>
            <span class="rate-watch__source">Polymarket</span>
        </div>
    </div>


    <!-- ============================================================
         KAZ-ERA PORTFOLIO
         ============================================================ -->
    <section class="section">
        <div class="section-title">Kaz-Era Portfolio (Acquired Nov 2025+)</div>

        <div class="split">
            <div class="panel">
                <div class="panel-title">Sold</div>
                <div class="big-num" id="kaz-sold-count">43</div>
                <div class="big-label">homes closed</div>
                <div style="margin-top: 16px;">
                    <div class="stat-row">
                        <span class="stat-label">Win Rate</span>
                        <span class="stat-value green" id="kaz-sold-wr">95.3%</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Avg Profit</span>
                        <span class="stat-value green" id="kaz-sold-profit">$43.2K</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Realized</span>
                        <span class="stat-value" id="kaz-sold-total">+$1.9M</span>
                    </div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-title">Still Listed</div>
                <div class="big-num" id="kaz-listed-count">103</div>
                <div class="big-label">homes on market</div>
                <div style="margin-top: 16px;">
                    <div class="stat-row">
                        <span class="stat-label">Above Water</span>
                        <span class="stat-value green" id="kaz-listed-above">97.1% (100)</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Underwater</span>
                        <span class="stat-value red" id="kaz-listed-uw">2.9% (3)</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">With Price Cuts</span>
                        <span class="stat-value amber" id="kaz-listed-cuts">35.0% (36)</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kaz-Era Net Position -->
        <div class="exposure">
            <div class="exposure-title">Kaz-Era Net Position</div>
            <div class="exposure-grid">
                <div class="exposure-item">
                    <div class="exposure-num green" id="kaz-realized">+$2.9M</div>
                    <div class="exposure-label">Realized Gains</div>
                </div>
                <div class="exposure-item">
                    <div class="exposure-num" id="kaz-unrealized">+$6.8M</div>
                    <div class="exposure-label">Unrealized (Above)</div>
                </div>
                <div class="exposure-item">
                    <div class="exposure-num red" id="kaz-uw-exposure">-$12.2K</div>
                    <div class="exposure-label">Underwater Exposure</div>
                </div>
            </div>
        </div>

        <!-- Kaz-Era Watchlist (Inline) -->
        <div class="watchlist">
            <div class="watchlist-header">
                <span><strong id="uw-count">3</strong> homes underwater</span>
                <span>Total exposure: <span class="red" id="uw-total">-$12.2K</span></span>
            </div>
            <table class="watchlist-table">
                <thead>
                    <tr>
                        <th>Location</th>
                        <th>Days</th>
                        <th>Underwater</th>
                        <th>Cuts</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="watchlist-body">
                    <tr>
                        <td class="name">Charlotte, NC</td>
                        <td>47</td>
                        <td class="red">-$10.5K</td>
                        <td>2</td>
                        <td><span class="status-badge concern">Concern</span></td>
                    </tr>
                    <tr>
                        <td class="name">Maricopa, AZ</td>
                        <td>15</td>
                        <td class="red">-$1.6K</td>
                        <td>1</td>
                        <td><span class="status-badge watching">Watching</span></td>
                    </tr>
                    <tr>
                        <td class="name">Stone Mountain, GA</td>
                        <td>18</td>
                        <td class="red">-$77</td>
                        <td>1</td>
                        <td><span class="status-badge watching">Watching</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ============================================================
         LEGACY PORTFOLIO
         ============================================================ -->
    <section class="section">
        <div class="section-title">Legacy Portfolio (Pre-Kaz)</div>

        <div class="split">
            <div class="panel">
                <div class="panel-title">Sold</div>
                <div class="big-num" id="legacy-sold-count">276</div>
                <div class="big-label">homes closed</div>
                <div style="margin-top: 16px;">
                    <div class="stat-row">
                        <span class="stat-label">Win Rate</span>
                        <span class="stat-value amber" id="legacy-sold-wr">64.5%</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Avg Profit</span>
                        <span class="stat-value" id="legacy-sold-profit">$23.7K</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Realized</span>
                        <span class="stat-value" id="legacy-sold-total">+$6.5M</span>
                    </div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-title">Still Listed</div>
                <div class="big-num" id="legacy-listed-count">661</div>
                <div class="big-label">homes on market</div>
                <div style="margin-top: 16px;">
                    <div class="stat-row">
                        <span class="stat-label">Above Water</span>
                        <span class="stat-value" id="legacy-listed-above">71.3% (471)</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Underwater</span>
                        <span class="stat-value red" id="legacy-listed-uw">28.7% (190)</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">With Price Cuts</span>
                        <span class="stat-value red" id="legacy-listed-cuts">96.1% (635)</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="exposure">
            <div class="exposure-title">Legacy Exposure</div>
            <div class="exposure-grid">
                <div class="exposure-item">
                    <div class="exposure-num red" id="legacy-uw-exposure">-$5.1M</div>
                    <div class="exposure-label">Underwater Exposure</div>
                </div>
                <div class="exposure-item">
                    <div class="exposure-num" id="legacy-toxic-remaining">84</div>
                    <div class="exposure-label">Toxic Remaining</div>
                </div>
                <div class="exposure-item">
                    <div class="exposure-num" id="legacy-weeks">~17 wks</div>
                    <div class="exposure-label">To Clear</div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================================
         TOXIC INVENTORY CLEARANCE
         ============================================================ -->
    <section class="toxic-clearance">
        <div class="toxic-clearance__title">Toxic Inventory Clearance</div>

        <div class="toxic-clearance__labels">
            <span class="toxic-clearance__cleared"><span id="toxic-cleared">43</span> cleared</span>
            <span class="toxic-clearance__remaining"><span id="toxic-remaining">84</span> remaining</span>
        </div>

        <div class="toxic-clearance__bar">
            <div class="toxic-clearance__fill" id="toxic-bar" style="width: 33.9%">
                <div class="toxic-clearance__marker"></div>
            </div>
        </div>

        <p class="toxic-clearance__projection">
            Clearing <strong><span id="clearance-rate">5</span> homes/week</strong> → Zero by early May
        </p>

        <div class="toxic-clearance__trend" id="toxic-weekly-trend">
            <!-- Populated dynamically -->
        </div>
    </section>

    <!-- ============================================================
         ACQUISITION PIPELINE
         ============================================================ -->
    <section class="acquisition-section">
        <div class="acquisition-section__title">Acquisition Pipeline (Inflow)</div>

        <div class="acquisition-metrics">
            <div class="acquisition-metric">
                <div class="acquisition-metric__value" id="acq-latest">287</div>
                <div class="acquisition-metric__label">Contracts This Week</div>
                <div class="acquisition-metric__delta up" id="acq-wow">+8% WoW</div>
            </div>
            <div class="acquisition-metric">
                <div class="acquisition-metric__value" id="acq-avg">240</div>
                <div class="acquisition-metric__label">4-Week Average</div>
            </div>
            <div class="acquisition-metric">
                <div class="acquisition-metric__value" id="acq-q1">959</div>
                <div class="acquisition-metric__label">Q1 Contracts</div>
                <div class="acquisition-metric__delta" id="acq-q1-weeks" style="color: var(--text-3);">4 weeks</div>
            </div>
        </div>

        <div class="acquisition-trend">
            <span>Recent weeks:</span>
            <div class="acquisition-trend__weeks" id="acq-trend">
                <span class="acquisition-trend__week">163</span> →
                <span class="acquisition-trend__week">146</span> →
                <span class="acquisition-trend__week">260</span> →
                <span class="acquisition-trend__week">266</span> →
                <span class="acquisition-trend__week">287</span>
            </div>
        </div>

        <div class="insight-text" data-metric="acquisition-insight" style="margin-top: 12px;"></div>
    </section>

    <!-- ============================================================
         PRODUCT UPDATES
         ============================================================ -->
    <section class="product-updates">
        <div class="product-updates__title">Recent Product Launches</div>

        <div class="product-updates__grid" id="product-grid">
            <div class="product-category ai">
                <div class="product-category__title">AI & Automation <span class="product-category__count">(4)</span></div>
                <div class="product-item">
                    <span class="product-item__name">In-House Vision Model</span>
                    <span class="product-item__date">12/12</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">End-to-End AI Home Scoping</span>
                    <span class="product-item__date">10/17</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">Automating Title & Escrow</span>
                    <span class="product-item__date">10/15</span>
                </div>
            </div>

            <div class="product-category seller">
                <div class="product-category__title">Seller Experience <span class="product-category__count">(2)</span></div>
                <div class="product-item">
                    <span class="product-item__name">100% Zip Coverage in Lower 48</span>
                    <span class="product-item__date">12/19</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">Market Expansion: Seattle, Baltimore, Chicago, Philly</span>
                    <span class="product-item__date">11/5</span>
                </div>
            </div>

            <div class="product-category buyer">
                <div class="product-category__title">Buyer Experience <span class="product-category__count">(3)</span></div>
                <div class="product-item">
                    <span class="product-item__name">Revamped Mortgage Experience</span>
                    <span class="product-item__date">12/8</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">USDC Payment Acceptance</span>
                    <span class="product-item__date">11/6</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">Buyer Peace of Mind Guarantee</span>
                    <span class="product-item__date">10/1</span>
                </div>
            </div>

            <div class="product-category acquisitions">
                <div class="product-category__title">Faster Acquisitions <span class="product-category__count">(3)</span></div>
                <div class="product-item">
                    <span class="product-item__name">New Homes Directory (SEO)</span>
                    <span class="product-item__date">11/13</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">Cash Plus Pricing Nationwide</span>
                    <span class="product-item__date">9/30</span>
                </div>
                <div class="product-item">
                    <span class="product-item__name">True Seller Model v2</span>
                    <span class="product-item__date">9/29</span>
                </div>
            </div>
        </div>

        <div class="insight-text" data-metric="product-insight" style="margin-top: 16px;"></div>
    </section>

    <!-- ============================================================
         PROBLEM HOMES DEEP DIVE
         ============================================================ -->
    <section class="problem-homes-section">
        <div class="problem-homes__title">Problem Homes Deep Dive</div>

        <div class="problem-homes__summary">
            <div class="problem-stat">
                <div class="problem-stat__value toxic" id="ph-toxic">84</div>
                <div class="problem-stat__label">Toxic (>365d)</div>
            </div>
            <div class="problem-stat">
                <div class="problem-stat__value stale" id="ph-very-stale">371</div>
                <div class="problem-stat__label">Very Stale (180-365d)</div>
            </div>
            <div class="problem-stat">
                <div class="problem-stat__value" id="ph-avg-dom">228</div>
                <div class="problem-stat__label">Avg Days on Market</div>
            </div>
            <div class="problem-stat">
                <div class="problem-stat__value pnl" id="ph-pnl">$58.6M</div>
                <div class="problem-stat__label">Unrealized P&L</div>
            </div>
        </div>

        <div class="problem-markets__title">Highest Risk Markets</div>

        <div id="problem-markets-list">
            <div class="problem-market critical">
                <div class="problem-market__info">
                    <div class="problem-market__state">OR (Oregon)</div>
                    <div class="problem-market__stats">
                        <span>10</span> homes, <span>4</span> toxic (40%), <span>353</span> avg DOM
                    </div>
                    <div class="problem-market__links">
                        <a href="https://www.opendoor.com/homes/portland" target="_blank" class="problem-market__link">Browse Portland</a>
                    </div>
                </div>
                <div class="problem-market__risk">
                    <div class="problem-market__risk-score">68</div>
                    <div class="problem-market__risk-label">Critical</div>
                </div>
            </div>

            <div class="problem-market high">
                <div class="problem-market__info">
                    <div class="problem-market__state">GA (Georgia)</div>
                    <div class="problem-market__stats">
                        <span>102</span> homes, <span>17</span> toxic (17%), <span>279</span> avg DOM
                    </div>
                    <div class="problem-market__links">
                        <a href="https://www.opendoor.com/homes/atlanta" target="_blank" class="problem-market__link">Browse Atlanta</a>
                    </div>
                </div>
                <div class="problem-market__risk">
                    <div class="problem-market__risk-score">51</div>
                    <div class="problem-market__risk-label">High</div>
                </div>
            </div>

            <div class="problem-market high">
                <div class="problem-market__info">
                    <div class="problem-market__state">FL (Florida)</div>
                    <div class="problem-market__stats">
                        <span>85</span> homes, <span>16</span> toxic (19%), <span>266</span> avg DOM
                    </div>
                    <div class="problem-market__links">
                        <a href="https://www.opendoor.com/homes/tampa" target="_blank" class="problem-market__link">Browse Tampa</a>
                        <a href="https://www.opendoor.com/homes/orlando" target="_blank" class="problem-market__link">Browse Orlando</a>
                    </div>
                </div>
                <div class="problem-market__risk">
                    <div class="problem-market__risk-score">51</div>
                    <div class="problem-market__risk-label">High</div>
                </div>
            </div>

            <div class="problem-market high">
                <div class="problem-market__info">
                    <div class="problem-market__state">CA (California)</div>
                    <div class="problem-market__stats">
                        <span>47</span> homes, <span>7</span> toxic (15%), <span>255</span> avg DOM
                    </div>
                    <div class="problem-market__links">
                        <a href="https://www.opendoor.com/homes/los-angeles" target="_blank" class="problem-market__link">Browse LA</a>
                        <a href="https://www.opendoor.com/homes/sacramento" target="_blank" class="problem-market__link">Browse Sacramento</a>
                    </div>
                </div>
                <div class="problem-market__risk">
                    <div class="problem-market__risk-score">47</div>
                    <div class="problem-market__risk-label">High</div>
                </div>
            </div>

            <div class="problem-market high">
                <div class="problem-market__info">
                    <div class="problem-market__state">CO (Colorado)</div>
                    <div class="problem-market__stats">
                        <span>34</span> homes, <span>4</span> toxic (12%), <span>260</span> avg DOM
                    </div>
                    <div class="problem-market__links">
                        <a href="https://www.opendoor.com/homes/denver" target="_blank" class="problem-market__link">Browse Denver</a>
                    </div>
                </div>
                <div class="problem-market__risk">
                    <div class="problem-market__risk-score">46</div>
                    <div class="problem-market__risk-label">High</div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================================
         CAREERS / HIRING
         ============================================================ -->
    <section class="careers-section">
        <div class="careers-section__title">Hiring Intelligence</div>

        <div class="careers-header">
            <div class="careers-total">
                <span class="careers-total__number" id="careers-total">52</span>
                <span class="careers-total__label">open positions</span>
            </div>
            <div class="careers-signal technology" id="careers-signal">Technology Focus</div>
        </div>

        <div class="careers-ai-insights" id="careers-ai-insights">
            <div class="careers-ai-insights__title">AI Strategic Analysis</div>
            <div class="careers-insight">Opendoor is heavily investing in multi-modal AI/ML capabilities with Research Scientists specifically focused on ConvNets and Transformers for processing both structured and unstructured data beyond just pricing models.</div>
            <div class="careers-insight">The company has adopted a 'Default to AI' philosophy with specialized roles tasked to '10x data leverage' through AI agents that automate financial workflows, forecasting, and reporting.</div>
            <div class="careers-insight">Expansion into adjacent revenue streams is materializing through dedicated roles for Treasury, Debt, and Adjacent Services operations and Directors focused on margin expansion through mortgage and insurance products.</div>
        </div>

        <div class="careers-highlights">
            <div>Eng: <span id="careers-eng">19</span></div>
            <div>Sales: <span id="careers-sales">13</span></div>
            <div>AI/ML: <span id="careers-ai">9</span></div>
            <div>Top: <span id="careers-location">Phoenix</span></div>
        </div>
    </section>

    <!-- ============================================================
         DAILY VELOCITY
         ============================================================ -->
    <section class="section">
        <div class="section-title">Daily Velocity</div>

        <div class="metrics-row">
            <div class="metric-card">
                <div class="metric-value" id="vel-homes">22.2</div>
                <div class="metric-label">Homes/Day</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="vel-avg-price">$388K</div>
                <div class="metric-label">Avg Home Price</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="vel-rev">$8.6M</div>
                <div class="metric-label">Revenue/Day</div>
            </div>
            <div class="metric-card">
                <div class="metric-value amber" id="vel-proj">$962M</div>
                <div class="metric-label">Q1 Projected</div>
            </div>
        </div>

        <div class="progress-bar" style="margin-top: 20px;">
            <div class="progress-fill" id="q1-progress" style="width: 20.1%; background: var(--amber);"></div>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-3); margin-top: 8px;">
            <span><span id="q1-rev">$119.7M</span> revenue</span>
            <span><span id="q1-pct">20.1%</span> of guidance • Tracking behind pace</span>
        </div>

        <!-- Revenue Chart -->
        <div class="chart-container">
            <div id="revenue-chart"></div>
        </div>

        <!-- Sales & Avg Price Chart -->
        <div class="section-title" style="margin-top: 32px;">Homes Sold & Avg Price</div>
        <div class="chart-container">
            <div id="sales-price-chart"></div>
        </div>

        <div class="insight-text" data-metric="velocity-insight"></div>
    </section>

    <!-- ============================================================
         COHORT PERFORMANCE
         ============================================================ -->
    <section class="section">
        <div class="section-title">Cohort Performance</div>

        <table class="tbl">
            <thead>
                <tr>
                    <th>Cohort</th>
                    <th>Sold</th>
                    <th>Win Rate</th>
                    <th>Margin</th>
                    <th>Avg Profit</th>
                </tr>
            </thead>
            <tbody id="cohort-table">
                <tr><td class="name">New (&lt;90d)</td><td>70</td><td class="green">92.9%</td><td class="green">10.7%</td><td class="green">$41.9K</td></tr>
                <tr><td class="name">Mid (90-180d)</td><td>104</td><td>84.6%</td><td>10.0%</td><td>$36.9K</td></tr>
                <tr><td class="name">Old (180-365d)</td><td>100</td><td class="amber">53.0%</td><td>5.4%</td><td>$21.7K</td></tr>
                <tr><td class="name">Toxic (&gt;365d)</td><td>43</td><td class="red">30.2%</td><td class="red">-4.1%</td><td class="red">-$12.5K</td></tr>
            </tbody>
        </table>

        <div class="insight-text" data-metric="pattern-insight"></div>
    </section>

    <!-- ============================================================
         RISK MONITORING
         ============================================================ -->
    <section class="section">
        <div class="section-title">Risk Monitoring</div>

        <div class="split">
            <!-- Top Markets -->
            <div class="panel">
                <div class="panel-title">Top Markets</div>
                <table class="tbl">
                    <thead>
                        <tr><th>City</th><th>Listings</th><th>Avg Price</th></tr>
                    </thead>
                    <tbody id="top-markets-table">
                        <tr><td class="name">Phoenix</td><td>21</td><td>$439K</td></tr>
                        <tr><td class="name">Houston</td><td>18</td><td>$312K</td></tr>
                        <tr><td class="name">San Antonio</td><td>16</td><td>$298K</td></tr>
                        <tr><td class="name">Dallas</td><td>14</td><td>$405K</td></tr>
                        <tr><td class="name">Atlanta</td><td>12</td><td>$378K</td></tr>
                    </tbody>
                </table>
                <div style="font-size: 11px; color: var(--text-3); margin-top: 8px;">
                    Top 5 markets = <span id="market-concentration">--</span>% of inventory
                </div>
            </div>

            <!-- Inventory Health -->
            <div class="panel">
                <div class="panel-title">Inventory Health</div>
                <table class="tbl">
                    <thead>
                        <tr><th>Metric</th><th>Value</th></tr>
                    </thead>
                    <tbody>
                        <tr><td class="name">Active Listings</td><td id="inv-total">764</td></tr>
                        <tr><td class="name">Avg Days on Market</td><td class="red" id="inv-dom">228</td></tr>
                        <tr><td class="name">Avg Price Cuts</td><td class="red" id="inv-cuts">6.4</td></tr>
                        <tr><td class="name">Homes with 3+ Cuts</td><td class="red" id="inv-3plus">571</td></tr>
                        <tr><td class="name">Inventory Value</td><td id="inv-value">$303M</td></tr>
                    </tbody>
                </table>
                <div class="insight-text" style="margin-top: 12px;" data-metric="guidance-insight"></div>
            </div>
        </div>
    </section>

    <!-- ============================================================
         THIS WEEK
         ============================================================ -->
    <section class="section">
        <div class="this-week">
            <div class="this-week__header">
                <span class="this-week__title">This Week</span>
                <span class="this-week__date" id="this-week-date">This Week</span>
            </div>

            <div class="this-week__group" id="this-week-improving">
                <div class="this-week__group-label improving">Improving</div>
                <div class="this-week__items" id="this-week-improving-items"></div>
            </div>

            <div class="this-week__group" id="this-week-stable">
                <div class="this-week__group-label stable">Stable</div>
                <div class="this-week__items" id="this-week-stable-items"></div>
            </div>

            <div class="this-week__group" id="this-week-watching">
                <div class="this-week__group-label watching">Watching</div>
                <div class="this-week__items" id="this-week-watching-items"></div>
            </div>
        </div>
    </section>

    <!-- ============================================================
         DATA TRANSPARENCY
         ============================================================ -->
    <div class="disclaimer">
        <div class="disclaimer-title">&#9888; Data Transparency</div>
        <div class="disclaimer-text">
            Win rates reflect <strong>sold homes only</strong>. Homes still listed may lose money when sold.<br><br>
            <strong>Q1 2026:</strong> <span data-metric="data-coverage">715 sales (38.7% with P&L)</span><br>
            <strong>Win Rate:</strong> <span data-metric="win-rate">79.1%</span> (from <span data-metric="pnl-sample">277</span> sales with P&L data)<br>
            <strong>Avg Profit:</strong> <span data-metric="avg-profit">$46,407</span> | <strong>Total Realized:</strong> <span data-metric="total-realized">$8.4M</span><br><br>
            <strong>How Margin is Calculated:</strong><br>
            Realized Net from Parcl includes <em>all costs</em>: renovation, holding costs (taxes, insurance), transaction fees, and commissions. Not simply Sale Price minus Purchase Price. Win = Realized Net > $0.<br><br>
            <strong>Guidance Target:</strong> $1B Q1 revenue. 29 homes/day target based on ~$388K avg price.<br><br>
            <strong>Data Sources:</strong><br>
            • Sales velocity & revenue: <a href="https://singularityresearchfund.com/opendoor-tracker" target="_blank" style="color: var(--text-2);">Singularity Research</a> (real-time)<br>
            • P&L & inventory metrics: Parcl Research<br><br>
            <span style="color: var(--text-3); font-size: 11px;">Data as of <span data-metric="as-of">Jan 26, 2026</span> | Unified dataset</span>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-brand">Glass House</div>
        <div class="footer-sub">Honest data for $OPEN shareholders • No survivorship bias</div>
        <div style="margin-top: 16px; font-size: 11px; color: var(--text-3);">
            Created by <a href="https://twitter.com/mabrrramsky" target="_blank" style="color: var(--text-2);">@mabrrramsky</a> • NFA, do your own research • <a href="https://twitter.com/mabrrramsky" target="_blank" style="color: var(--text-2);">DM ideas & feedback</a>
        </div>
    </footer>

</div>

<script>
// ============================================================
// UTILITIES
// ============================================================
function fmt(v) {
    if (Math.abs(v) >= 1e6) return '$' + (v/1e6).toFixed(1) + 'M';
    if (Math.abs(v) >= 1e3) return '$' + (v/1e3).toFixed(1) + 'K';
    return '$' + v.toFixed(0);
}

function formatDate(dateStr) {
    const d = new Date(dateStr);
    return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
}

// ============================================================
// REVENUE CHART - DAILY REVENUE (Sample Data)
// ============================================================
function renderRevenueChart(data) {
    const el = document.getElementById('revenue-chart');
    if (!el) return;

    // Use data from unified dataset, or fallback to defaults
    let chartData;
    if (data && data.revenue_chart && data.revenue_chart.length > 0) {
        chartData = data.revenue_chart.map(d => ({
            date: d.date,
            revenue: d.revenue,
            sales: d.sales_count
        }));
    } else {
        // Fallback data if JSON not loaded
        chartData = [
            { date: 'Jan 01', revenue: 3840000, sales: 9 },
            { date: 'Jan 02', revenue: 1330000, sales: 5 },
            { date: 'Jan 03', revenue: 4940000, sales: 14 },
            { date: 'Jan 04', revenue: 10220000, sales: 27 },
            { date: 'Jan 05', revenue: 9070000, sales: 25 },
            { date: 'Jan 06', revenue: 6930000, sales: 19 },
            { date: 'Jan 07', revenue: 9090000, sales: 20 },
            { date: 'Jan 08', revenue: 8310000, sales: 20 },
            { date: 'Jan 09', revenue: 9750000, sales: 26 },
            { date: 'Jan 10', revenue: 3730000, sales: 11 },
            { date: 'Jan 11', revenue: 2860000, sales: 9 },
            { date: 'Jan 12', revenue: 10840000, sales: 25 },
            { date: 'Jan 13', revenue: 10170000, sales: 27 },
            { date: 'Jan 14', revenue: 12320000, sales: 33 },
            { date: 'Jan 15', revenue: 8370000, sales: 20 },
            { date: 'Jan 16', revenue: 9430000, sales: 25 },
            { date: 'Jan 17', revenue: 3180000, sales: 9 },
            { date: 'Jan 18', revenue: 5090000, sales: 14 },
            { date: 'Jan 19', revenue: 8530000, sales: 24 },
            { date: 'Jan 20', revenue: 14270000, sales: 41 },
            { date: 'Jan 21', revenue: 13270000, sales: 33 },
            { date: 'Jan 22', revenue: 15810000, sales: 40 },
            { date: 'Jan 23', revenue: 12930000, sales: 31 },
            { date: 'Jan 24', revenue: 2780000, sales: 9 },
            { date: 'Jan 25', revenue: 5880000, sales: 18 },
            { date: 'Jan 26', revenue: 14380000, sales: 37 }
        ];
    }

    // Q1 guidance: $1B / 90 days = $11.1M/day target
    const TARGET = 11100000;
    const dates = chartData.map(d => d.date);
    const revenues = chartData.map(d => d.revenue);
    const salesCounts = chartData.map(d => d.sales || 0);
    // Calmer colors - darker green for above target, muted amber for below
    const colors = revenues.map(r => r >= TARGET ? '#16a34a' : '#d97706');

    const traces = [
        {
            x: dates,
            y: revenues,
            type: 'bar',
            marker: {
                color: colors,
                line: { color: colors.map(c => c === '#16a34a' ? '#15803d' : '#b45309'), width: 1 }
            },
            hovertemplate: '%{x}<br>%{customdata[0]}<br>%{customdata[1]} sales<extra></extra>',
            customdata: revenues.map((r, i) => [fmt(r), salesCounts[i]]),
            text: revenues.map(r => fmt(r))
        },
        {
            x: [dates[0], dates[dates.length - 1]],
            y: [TARGET, TARGET],
            type: 'scatter',
            mode: 'lines',
            line: { color: '#f59e0b', width: 2, dash: 'dash' },
            hoverinfo: 'skip',
            showlegend: false
        }
    ];

    const layout = {
        paper_bgcolor: '#141414',
        plot_bgcolor: '#141414',
        font: { color: '#a0a0a0', family: 'Inter, sans-serif', size: 11 },
        margin: { t: 30, r: 30, b: 60, l: 60 },
        showlegend: false,
        bargap: 0.3,
        xaxis: {
            tickangle: -30,
            gridcolor: 'transparent',
            linecolor: '#333',
            showline: true,
            showticklabels: true,
            tickfont: { size: 10, family: 'JetBrains Mono, monospace', color: '#888' },
            ticks: 'outside',
            tickcolor: '#333'
        },
        yaxis: {
            range: [0, 20000000],
            tickmode: 'array',
            tickvals: [0, 5000000, 10000000, 15000000, 20000000],
            ticktext: ['$0', '$5M', '$10M', '$15M', '$20M'],
            showline: true,
            showticklabels: true,
            gridcolor: '#262626',
            linecolor: '#333',
            tickfont: { size: 10, family: 'JetBrains Mono, monospace', color: '#888' },
            ticks: 'outside',
            tickcolor: '#333',
            zeroline: true,
            zerolinecolor: '#333'
        },
        annotations: [{
            x: dates[Math.floor(dates.length / 2)],
            y: TARGET,
            text: '  $11.1M/day target (Q1 guidance)',
            showarrow: false,
            xanchor: 'left',
            yanchor: 'bottom',
            font: { size: 11, color: '#f59e0b', family: 'Inter, sans-serif' }
        }]
    };

    Plotly.newPlot(el, traces, layout, { displayModeBar: false, responsive: true });
}

// ============================================================
// SALES & AVG PRICE CHART
// ============================================================
function renderSalesPriceChart(data) {
    const el = document.getElementById('sales-price-chart');
    if (!el) return;

    let chartData;
    if (data && data.sales_chart && data.sales_chart.length > 0) {
        chartData = data.sales_chart;
    } else {
        return; // No fallback, need real data
    }

    const dates = chartData.map(d => d.date);
    const salesCounts = chartData.map(d => d.count);
    const avgPrices = chartData.map(d => d.avg_price || 0);
    const movingAvg = chartData.map(d => d.moving_avg);

    // Target: $1B guidance / $388K avg price / 90 days = ~29 homes/day
    const SALES_TARGET = 29;

    // Colors for bars based on target
    const barColors = salesCounts.map(s => s >= SALES_TARGET ? '#16a34a' : '#d97706');

    const traces = [
        // Bars for homes sold
        {
            x: dates,
            y: salesCounts,
            type: 'bar',
            name: 'Homes Sold',
            marker: {
                color: barColors,
                line: { color: barColors.map(c => c === '#16a34a' ? '#15803d' : '#b45309'), width: 1 }
            },
            hovertemplate: '%{x}<br>%{y} homes<extra></extra>',
            yaxis: 'y'
        },
        // 30-day moving average line
        {
            x: dates,
            y: movingAvg,
            type: 'scatter',
            mode: 'lines',
            name: '30d Avg',
            line: { color: '#3b82f6', width: 2 },
            hovertemplate: '%{x}<br>30d avg: %{y:.1f}<extra></extra>',
            yaxis: 'y'
        },
        // Avg price line (secondary axis)
        {
            x: dates,
            y: avgPrices,
            type: 'scatter',
            mode: 'lines',
            name: 'Avg Price',
            line: { color: '#a855f7', width: 2 },
            hovertemplate: '%{x}<br>Avg: $%{y:,.0f}<extra></extra>',
            yaxis: 'y2'
        },
        // Target line at 29 homes/day
        {
            x: [dates[0], dates[dates.length - 1]],
            y: [SALES_TARGET, SALES_TARGET],
            type: 'scatter',
            mode: 'lines',
            name: 'Target (29/day)',
            line: { color: '#f59e0b', width: 2, dash: 'dash' },
            hoverinfo: 'skip',
            yaxis: 'y'
        }
    ];

    const layout = {
        paper_bgcolor: '#141414',
        plot_bgcolor: '#141414',
        font: { color: '#a0a0a0', family: 'Inter, sans-serif', size: 11 },
        margin: { t: 30, r: 70, b: 60, l: 50 },
        showlegend: true,
        legend: {
            x: 0,
            y: 1.15,
            orientation: 'h',
            font: { size: 10 }
        },
        bargap: 0.3,
        xaxis: {
            tickangle: -30,
            gridcolor: 'transparent',
            linecolor: '#333',
            showline: true,
            tickfont: { size: 10, family: 'JetBrains Mono, monospace', color: '#888' },
            ticks: 'outside',
            tickcolor: '#333'
        },
        yaxis: {
            title: { text: 'Homes Sold', font: { size: 10, color: '#888' } },
            range: [0, 50],
            showline: true,
            gridcolor: '#262626',
            linecolor: '#333',
            tickfont: { size: 10, family: 'JetBrains Mono, monospace', color: '#888' },
            ticks: 'outside',
            tickcolor: '#333'
        },
        yaxis2: {
            title: { text: 'Avg Price', font: { size: 10, color: '#a855f7' } },
            overlaying: 'y',
            side: 'right',
            range: [200000, 600000],
            tickmode: 'array',
            tickvals: [200000, 300000, 400000, 500000, 600000],
            ticktext: ['$200K', '$300K', '$400K', '$500K', '$600K'],
            showgrid: false,
            linecolor: '#333',
            tickfont: { size: 10, family: 'JetBrains Mono, monospace', color: '#a855f7' },
            ticks: 'outside',
            tickcolor: '#333'
        },
        annotations: [{
            x: dates[Math.floor(dates.length * 0.7)],
            y: SALES_TARGET,
            text: '29/day needed for $1B guidance',
            showarrow: false,
            xanchor: 'left',
            yanchor: 'bottom',
            font: { size: 10, color: '#f59e0b', family: 'Inter, sans-serif' }
        }]
    };

    Plotly.newPlot(el, traces, layout, { displayModeBar: false, responsive: true });
}

// ============================================================
// SCREENSHOT MODE
// ============================================================
function toggleScreenshotMode() {
    document.body.classList.toggle('screenshot-mode');
}

document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'S') {
        e.preventDefault();
        toggleScreenshotMode();
    }
});

// ============================================================
// INIT
// ============================================================
async function init() {
    try {
        const r = await fetch('outputs/unified_dashboard_data.json');
        if (r.ok) {
            const data = await r.json();
            renderRevenueChart(data);
            renderSalesPriceChart(data);
            updateDashboardMetrics(data);
            updateThisWeekNarrative(data);
            updateToxicWeeklyTrend(data);
            updateRateWatch(data);
        } else {
            renderRevenueChart(null);
        }
    } catch (e) {
        console.error('Failed to load dashboard data:', e);
        renderRevenueChart(null);
    }

    // Fetch stock price
    fetchStockPrice();
    // Refresh every 30 minutes
    setInterval(fetchStockPrice, 30 * 60 * 1000);

    // Load acquisition data
    loadAcquisitionData();

    // Load careers data
    loadCareersData();

    // Load problem homes data
    loadProblemHomesData();

    // Load portfolio data (Kaz-Era & Legacy)
    loadPortfolioData();
}

async function fetchStockPrice() {
    const ticker = document.getElementById('stock-ticker');
    if (!ticker) return;

    try {
        // Use Yahoo Finance via a CORS proxy
        const response = await fetch('https://query1.finance.yahoo.com/v8/finance/chart/OPEN?interval=1d&range=1d');
        if (response.ok) {
            const data = await response.json();
            const price = data.chart.result[0].meta.regularMarketPrice;
            const prevClose = data.chart.result[0].meta.previousClose;
            const change = ((price - prevClose) / prevClose * 100).toFixed(2);
            const arrow = change >= 0 ? '▲' : '▼';
            const color = change >= 0 ? '#22c55e' : '#ef4444';
            ticker.innerHTML = `$OPEN <span style="color:${color}">$${price.toFixed(2)} ${arrow}${Math.abs(change)}%</span>`;
        }
    } catch (e) {
        // Fallback: try alternative API
        try {
            const resp = await fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent('https://query1.finance.yahoo.com/v8/finance/chart/OPEN?interval=1d&range=1d'));
            if (resp.ok) {
                const data = await resp.json();
                const price = data.chart.result[0].meta.regularMarketPrice;
                ticker.textContent = `$OPEN $${price.toFixed(2)}`;
            }
        } catch (e2) {
            ticker.textContent = '$OPEN --';
        }
    }
}

// Helper to try fetching from multiple dates (today, then up to 7 days back)
async function fetchWithDateFallback(prefix, suffix = '.json') {
    const today = new Date();
    for (let i = 0; i < 7; i++) {
        const date = new Date(today);
        date.setDate(date.getDate() - i);
        const dateStr = date.toISOString().split('T')[0];
        try {
            const r = await fetch(`outputs/${prefix}${dateStr}${suffix}`);
            if (r.ok) return await r.json();
        } catch (e) { /* try next date */ }
    }
    return null;
}

// Load and display acquisition data
async function loadAcquisitionData() {
    try {
        const acqData = await fetchWithDateFallback('accountability_');
        if (acqData) {
            updateAcquisitionSection(acqData);
        }
    } catch (e) {
        console.log('Acquisition data not available:', e);
    }
}

function updateAcquisitionSection(data) {
    if (!data || !data.latest) return;

    const latest = data.latest;
    const contracts = data.weekly_contracts || [];

    // Update main metrics
    const acqLatest = document.getElementById('acq-latest');
    if (acqLatest) acqLatest.textContent = latest.contracts?.toLocaleString() || '—';

    const acqWow = document.getElementById('acq-wow');
    if (acqWow && latest.wow_change !== undefined) {
        const arrow = latest.wow_change >= 0 ? '+' : '';
        acqWow.textContent = `${arrow}${latest.wow_change}% WoW`;
        acqWow.className = 'acquisition-metric__delta ' + (latest.wow_change >= 0 ? 'up' : 'down');
    } else if (acqWow && latest.wow_display !== undefined) {
        const arrow = latest.wow_display >= 0 ? '+' : '';
        acqWow.textContent = `${arrow}${latest.wow_display}% WoW`;
        acqWow.className = 'acquisition-metric__delta ' + (latest.wow_display >= 0 ? 'up' : 'down');
    }

    const acqAvg = document.getElementById('acq-avg');
    if (acqAvg) acqAvg.textContent = Math.round(latest.avg_4w || 0).toLocaleString();

    const acqQ1 = document.getElementById('acq-q1');
    if (acqQ1) acqQ1.textContent = (latest.q1_total || 0).toLocaleString();

    const acqQ1Weeks = document.getElementById('acq-q1-weeks');
    if (acqQ1Weeks) acqQ1Weeks.textContent = `${latest.q1_weeks || 0} weeks`;

    // Update trend display (last 5 weeks)
    const acqTrend = document.getElementById('acq-trend');
    if (acqTrend && contracts.length > 0) {
        const last5 = contracts.slice(-5);
        const trendHtml = last5.map((w, i) =>
            `<span class="acquisition-trend__week">${w.actual}</span>` +
            (i < last5.length - 1 ? ' → ' : '')
        ).join('');
        acqTrend.innerHTML = trendHtml;
    }

    // Update product updates section
    const products = data.product_updates || [];
    if (products.length > 0) {
        updateProductUpdates(products);
    }
}

function updateProductUpdates(products) {
    const grid = document.getElementById('product-grid');
    if (!grid || !products.length) return;

    // Group by category
    const byCategory = {};
    const categoryColors = {
        'AI & Automation': 'ai',
        'Buyer Experience': 'buyer',
        'Seller Experience': 'seller',
        'Agent & Partner': 'agent',
        'Faster Acquisitions': 'acquisitions',
        'Operations': 'ai',
        'Other': 'agent'
    };

    for (const p of products) {
        const cat = p.category || 'Other';
        if (!byCategory[cat]) byCategory[cat] = [];
        byCategory[cat].push(p);
    }

    // Build HTML
    let html = '';
    for (const [category, items] of Object.entries(byCategory)) {
        const colorClass = categoryColors[category] || 'agent';
        const displayItems = items.slice(0, 3); // Show top 3 per category

        html += `
            <div class="product-category ${colorClass}">
                <div class="product-category__title">${category} <span class="product-category__count">(${items.length})</span></div>
                ${displayItems.map(item => {
                    const dateParts = item.date.split('/');
                    const shortDate = dateParts.length >= 2 ? `${dateParts[0]}/${dateParts[1]}` : item.date;
                    return `<div class="product-item">
                        <span class="product-item__name">${item.name}</span>
                        <span class="product-item__date">${shortDate}</span>
                    </div>`;
                }).join('')}
            </div>
        `;
    }

    grid.innerHTML = html;
}

// Load and display careers data
async function loadCareersData() {
    try {
        const careersData = await fetchWithDateFallback('careers_');
        if (careersData) {
            updateCareersSection(careersData);
        }
    } catch (e) {
        console.log('Careers data not available:', e);
    }
}

function updateCareersSection(data) {
    if (!data || !data.summary) return;

    const summary = data.summary;
    const byDept = data.by_department || {};

    // Update total
    const totalEl = document.getElementById('careers-total');
    if (totalEl) totalEl.textContent = summary.total_positions || 0;

    // Update signal badge
    const signalEl = document.getElementById('careers-signal');
    if (signalEl && summary.hiring_signal) {
        const focus = summary.hiring_signal.focus || 'balanced';
        signalEl.className = 'careers-signal ' + focus;
        signalEl.textContent = summary.hiring_signal.description || 'Active Hiring';
    }

    // Update AI insights
    const insightsEl = document.getElementById('careers-ai-insights');
    if (insightsEl && data.ai_insights && data.ai_insights.length > 0) {
        let html = '<div class="careers-ai-insights__title">AI Strategic Analysis</div>';
        for (const insight of data.ai_insights) {
            html += `<div class="careers-insight">${insight}</div>`;
        }
        insightsEl.innerHTML = html;
    }

    // Update compact highlights
    const engEl = document.getElementById('careers-eng');
    if (engEl && byDept['Engineering & Technology']) {
        engEl.textContent = byDept['Engineering & Technology'].count;
    }

    const salesEl = document.getElementById('careers-sales');
    if (salesEl && byDept['Sales & Customer Experience']) {
        salesEl.textContent = byDept['Sales & Customer Experience'].count;
    }

    const aiEl = document.getElementById('careers-ai');
    if (aiEl) aiEl.textContent = summary.ai_ml_roles_count || 0;

    const locationEl = document.getElementById('careers-location');
    if (locationEl && summary.top_locations && summary.top_locations.length > 0) {
        const top = summary.top_locations[0];
        const shortLoc = top.name.split(',')[0].replace('Office - ', '').replace('Washington-', '');
        locationEl.textContent = shortLoc;
    }
}

// Load and display problem homes data
async function loadProblemHomesData() {
    try {
        const data = await fetchWithDateFallback('problem_homes_');
        if (data) {
            updateProblemHomesSection(data);
        }
    } catch (e) {
        console.log('Problem homes data not available:', e);
    }
}

function updateProblemHomesSection(data) {
    if (!data || !data.summary) return;

    const summary = data.summary;

    // Update summary stats
    const toxicEl = document.getElementById('ph-toxic');
    if (toxicEl) toxicEl.textContent = summary.total_toxic || 0;

    const staleEl = document.getElementById('ph-very-stale');
    if (staleEl) staleEl.textContent = summary.total_very_stale || 0;

    const domEl = document.getElementById('ph-avg-dom');
    if (domEl) domEl.textContent = summary.avg_dom || 0;

    const pnlEl = document.getElementById('ph-pnl');
    if (pnlEl) {
        const pnl = summary.unrealized_pnl_millions || 0;
        pnlEl.textContent = `$${Math.abs(pnl).toFixed(1)}M`;
    }

    // Update markets list
    const marketsEl = document.getElementById('problem-markets-list');
    if (marketsEl && data.top_problem_markets) {
        const stateNames = {
            'AZ': 'Arizona', 'CA': 'California', 'CO': 'Colorado', 'FL': 'Florida',
            'GA': 'Georgia', 'IN': 'Indiana', 'KS': 'Kansas', 'MD': 'Maryland',
            'MI': 'Michigan', 'MN': 'Minnesota', 'MO': 'Missouri', 'NC': 'North Carolina',
            'NV': 'Nevada', 'NJ': 'New Jersey', 'OH': 'Ohio', 'OK': 'Oklahoma',
            'OR': 'Oregon', 'SC': 'South Carolina', 'TN': 'Tennessee', 'TX': 'Texas',
            'UT': 'Utah', 'VA': 'Virginia', 'WA': 'Washington'
        };

        let html = '';
        for (const market of data.top_problem_markets.slice(0, 5)) {
            const stateName = stateNames[market.state] || market.state;
            const riskClass = market.risk_level || 'moderate';

            // Build links
            let linksHtml = '';
            if (market.opendoor_links) {
                for (const link of market.opendoor_links.slice(0, 2)) {
                    linksHtml += `<a href="${link.url}" target="_blank" class="problem-market__link">Browse ${link.name}</a>`;
                }
            }

            html += `
                <div class="problem-market ${riskClass}">
                    <div class="problem-market__info">
                        <div class="problem-market__state">${market.state} (${stateName})</div>
                        <div class="problem-market__stats">
                            <span>${market.inventory}</span> homes, <span>${market.toxic_count}</span> toxic (${market.toxic_pct}%), <span>${market.avg_dom}</span> avg DOM
                        </div>
                        <div class="problem-market__links">${linksHtml}</div>
                    </div>
                    <div class="problem-market__risk">
                        <div class="problem-market__risk-score">${Math.round(market.risk_score)}</div>
                        <div class="problem-market__risk-label">${market.risk_level}</div>
                    </div>
                </div>
            `;
        }
        marketsEl.innerHTML = html;
    }
}

// Update dashboard metrics from unified data
function updateDashboardMetrics(data) {
    if (!data) return;

    // Update timestamp
    const tsEl = document.querySelector('.header__timestamp');
    if (tsEl && data.as_of) {
        const asOf = new Date(data.as_of + 'T12:00:00');
        const formatted = asOf.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        tsEl.textContent = `Data as of ${formatted}`;
    }
    updateText('[data-metric="as-of"]', data.as_of);

    // Update "This Week" date range
    if (data.as_of) {
        const endDate = new Date(data.as_of + 'T12:00:00');
        const startDate = new Date(endDate);
        startDate.setDate(startDate.getDate() - 6);
        const startStr = startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        const endStr = endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        const weekEl = document.getElementById('this-week-date');
        if (weekEl) weekEl.textContent = `${startStr} - ${endStr}`;
    }

    // Update velocity metrics
    if (data.velocity) {
        updateText('[data-metric="q1-sales"]', data.velocity.q1_sales?.toLocaleString());
        updateText('[data-metric="q1-revenue"]', '$' + (data.velocity.q1_revenue / 1000000).toFixed(1) + 'M');
        updateText('[data-metric="daily-avg-sales"]', data.velocity.daily_avg_sales?.toFixed(1));

        // Update velocity cards
        const velHomes = document.getElementById('vel-homes');
        if (velHomes) velHomes.textContent = data.velocity.daily_avg_sales?.toFixed(1);

        const velAvgPrice = document.getElementById('vel-avg-price');
        if (velAvgPrice && data.velocity.avg_home_price) {
            velAvgPrice.textContent = '$' + Math.round(data.velocity.avg_home_price / 1000) + 'K';
        }

        const velRev = document.getElementById('vel-rev');
        if (velRev) velRev.textContent = '$' + (data.velocity.daily_avg_revenue / 1000000).toFixed(1) + 'M';

        const velProj = document.getElementById('vel-proj');
        if (velProj && data.guidance) {
            velProj.textContent = '$' + Math.round(data.guidance.projected_revenue / 1000000) + 'M';
        }
    }

    // Update P&L metrics
    if (data.pnl) {
        // Update all instances of win-rate
        document.querySelectorAll('[data-metric="win-rate"]').forEach(el => {
            el.textContent = data.pnl.win_rate?.toFixed(1) + '%';
        });
        updateText('[data-metric="avg-profit"]', '$' + data.pnl.avg_profit?.toLocaleString());
        // Update all instances of total-realized
        document.querySelectorAll('[data-metric="total-realized"]').forEach(el => {
            el.textContent = '$' + (data.pnl.total_realized / 1000000).toFixed(1) + 'M';
        });
        updateText('[data-metric="pnl-coverage"]', data.pnl.coverage_pct?.toFixed(0) + '%');
        updateText('[data-metric="pnl-sample"]', (data.pnl.wins + data.pnl.losses)?.toLocaleString());
    }

    // Update guidance tracking
    if (data.guidance) {
        updateText('[data-metric="pacing"]', data.guidance.pacing_pct?.toFixed(1) + '%');
        updateText('[data-metric="days-elapsed"]', data.guidance.days_elapsed);
        updateText('[data-metric="days-remaining"]', data.guidance.days_remaining);
    }

    // Update data quality info
    if (data.data_quality) {
        updateText('[data-metric="data-coverage"]',
            `${data.data_quality.total_records} sales (${data.data_quality.pnl_coverage}% with P&L)`);
    }

    // Update AI insights
    if (data.ai_insights) {
        updateText('[data-metric="velocity-insight"]', data.ai_insights.velocity_insight);
        updateText('[data-metric="guidance-insight"]', data.ai_insights.guidance_insight);
        updateText('[data-metric="pattern-insight"]', data.ai_insights.pattern_insight);
        updateText('[data-metric="acquisition-insight"]', data.ai_insights.acquisition_insight);
        updateText('[data-metric="product-insight"]', data.ai_insights.product_insight);
    }

    // Update Top Markets table
    if (data.top_markets) {
        const tableBody = document.getElementById('top-markets-table');
        if (tableBody) {
            tableBody.innerHTML = data.top_markets.slice(0, 5).map(m =>
                `<tr><td class="name">${m.city}</td><td>${m.listings}</td><td>$${Math.round(m.avg_price / 1000)}K</td></tr>`
            ).join('');
        }
    }

    // Update market concentration
    if (data.market_concentration) {
        const concEl = document.getElementById('market-concentration');
        if (concEl) concEl.textContent = data.market_concentration.top5_pct;
    }

    // Update cohort table
    if (data.cohorts) {
        const cohortTable = document.getElementById('cohort-table');
        if (cohortTable) {
            const c = data.cohorts;
            const avgPrice = data.velocity?.avg_home_price || 387000;
            const formatProfit = (v) => v >= 0 ? '$' + (v/1000).toFixed(1) + 'K' : '-$' + Math.abs(v/1000).toFixed(1) + 'K';
            const formatMargin = (profit) => {
                const margin = (profit / avgPrice * 100);
                return margin >= 0 ? margin.toFixed(1) + '%' : margin.toFixed(1) + '%';
            };
            const wrClass = (wr) => wr >= 80 ? 'green' : (wr >= 50 ? 'amber' : 'red');
            const profitClass = (p) => p >= 30000 ? 'green' : (p >= 0 ? '' : 'red');
            const marginClass = (p) => (p / avgPrice * 100) >= 8 ? 'green' : ((p / avgPrice * 100) >= 0 ? '' : 'red');

            cohortTable.innerHTML = `
                <tr><td class="name">New (&lt;90d)</td><td>${c.new.count}</td><td class="${wrClass(c.new.win_rate)}">${c.new.win_rate.toFixed(1)}%</td><td class="${marginClass(c.new.avg_profit)}">${formatMargin(c.new.avg_profit)}</td><td class="${profitClass(c.new.avg_profit)}">${formatProfit(c.new.avg_profit)}</td></tr>
                <tr><td class="name">Mid (90-180d)</td><td>${c.mid.count}</td><td class="${wrClass(c.mid.win_rate)}">${c.mid.win_rate.toFixed(1)}%</td><td class="${marginClass(c.mid.avg_profit)}">${formatMargin(c.mid.avg_profit)}</td><td class="${profitClass(c.mid.avg_profit)}">${formatProfit(c.mid.avg_profit)}</td></tr>
                <tr><td class="name">Old (180-365d)</td><td>${c.old.count}</td><td class="${wrClass(c.old.win_rate)}">${c.old.win_rate.toFixed(1)}%</td><td class="${marginClass(c.old.avg_profit)}">${formatMargin(c.old.avg_profit)}</td><td class="${profitClass(c.old.avg_profit)}">${formatProfit(c.old.avg_profit)}</td></tr>
                <tr><td class="name">Toxic (&gt;365d)</td><td>${c.toxic.count}</td><td class="${wrClass(c.toxic.win_rate)}">${c.toxic.win_rate.toFixed(1)}%</td><td class="${marginClass(c.toxic.avg_profit)}">${formatMargin(c.toxic.avg_profit)}</td><td class="${profitClass(c.toxic.avg_profit)}">${formatProfit(c.toxic.avg_profit)}</td></tr>
            `;
        }
    }

    // Update inventory metrics
    if (data.inventory) {
        const inv = data.inventory;
        const invTotal = document.getElementById('inv-total');
        if (invTotal) invTotal.textContent = inv.total_listings?.toLocaleString();

        const invDom = document.getElementById('inv-dom');
        if (invDom) invDom.textContent = inv.avg_days_on_market;

        const invCuts = document.getElementById('inv-cuts');
        if (invCuts) invCuts.textContent = inv.avg_price_cuts;

        const inv3plus = document.getElementById('inv-3plus');
        if (inv3plus) inv3plus.textContent = inv.homes_with_3plus_cuts?.toLocaleString();

        const invValue = document.getElementById('inv-value');
        if (invValue) invValue.textContent = '$' + Math.round(inv.total_inventory_value / 1000000) + 'M';
    }
}

// Update "This Week" narrative section from data
function updateThisWeekNarrative(data) {
    const narrative = data.this_week_narrative;
    if (!narrative) return;

    const icons = {
        improving: '&#10003;',
        stable: '—',
        watching: '&#9888;'
    };

    ['improving', 'stable', 'watching'].forEach(category => {
        const container = document.getElementById(`this-week-${category}-items`);
        const groupEl = document.getElementById(`this-week-${category}`);
        const items = narrative[category] || [];

        if (container && items.length > 0) {
            container.innerHTML = items.map(text =>
                `<div class="this-week__item ${category}">
                    <span class="this-week__icon">${icons[category]}</span>
                    <span>${text}</span>
                </div>`
            ).join('');
            if (groupEl) groupEl.style.display = 'block';
        } else if (groupEl && items.length === 0) {
            groupEl.style.display = 'none';
        }
    });
}

// Update toxic weekly trend from data
function updateToxicWeeklyTrend(data) {
    const trend = data.toxic_weekly_trend || [];
    const container = document.getElementById('toxic-weekly-trend');
    if (!container) return;

    if (trend.length === 0) {
        // Fallback if no trend data
        container.innerHTML = 'Week 1: <span>—</span> → Week 2: <span>—</span> → Week 3: <span>—</span> → Week 4: <span>—</span>';
        return;
    }

    const trendHtml = trend.map((week, i) => {
        const weekNum = i + 1;
        const arrow = i < trend.length - 1 ? ' →' : '';
        return `Week ${weekNum}: <span>${week.toxic_count}</span>${arrow}`;
    }).join('\n            ');

    container.innerHTML = trendHtml;
}

// Update Rate Watch bar from market intel
function updateRateWatch(data) {
    const intel = data.market_intel;
    if (!intel) return;

    const rates = intel.mortgage_rates || {};
    const fedData = intel.fed_data || {};

    // 30Y Mortgage Rate
    const rate30y = document.getElementById('rate-30y');
    const rate30yChange = document.getElementById('rate-30y-change');
    if (rate30y && rates.rate_30yr) {
        rate30y.textContent = rates.rate_30yr + '%';

        // Show monthly change
        const mtdChange = rates.rate_change_1m || 0;
        const changeClass = mtdChange < 0 ? 'down' : mtdChange > 0 ? 'up' : '';
        const changeText = mtdChange < 0 ? `▼${Math.abs(mtdChange).toFixed(2)}% MTD` :
                          mtdChange > 0 ? `▲${mtdChange.toFixed(2)}% MTD` : 'unchanged';
        rate30yChange.textContent = changeText;
        rate30yChange.className = 'rate-watch__sub ' + changeClass;
    }

    // Fed Funds Rate
    const fedFunds = document.getElementById('fed-funds');
    const fedStatus = document.getElementById('fed-status');
    if (fedFunds) {
        fedFunds.textContent = fedData.current_rate || '4.25-4.50%';
    }
    if (fedStatus) {
        const status = fedData.last_action || 'hold';
        fedStatus.textContent = status.toUpperCase();
        fedStatus.className = 'rate-watch__status ' + status.toLowerCase();
    }

    // Next FOMC Meeting
    const nextFomc = document.getElementById('next-fomc');
    if (nextFomc) {
        nextFomc.textContent = fedData.next_meeting || 'Mar 18-19';
    }

    // Polymarket 2026 Rate Cuts
    const polymarket = fedData.polymarket || {};
    const polymarketCuts = document.getElementById('polymarket-cuts');
    const polymarketPct = document.getElementById('polymarket-pct');
    if (polymarketCuts && polymarket.most_likely_cuts !== null) {
        const cuts = polymarket.most_likely_cuts;
        polymarketCuts.textContent = cuts === 0 ? '0' : String(cuts);
    }
    if (polymarketPct && polymarket.most_likely_pct) {
        polymarketPct.textContent = `@ ${polymarket.most_likely_pct}% odds`;
        polymarketPct.className = 'rate-watch__sub';
    }
}

// Load and display portfolio data (Kaz-Era & Legacy)
async function loadPortfolioData() {
    try {
        const r = await fetch('outputs/dashboard_data.json');
        if (r.ok) {
            const data = await r.json();
            if (data.current) {
                if (data.current.v3) {
                    updatePortfolioSections(data.current.v3);
                }
                if (data.current.toxic) {
                    updateToxicClearance(data.current.toxic);
                }
            }
        }
    } catch (e) {
        console.log('Portfolio data not available:', e);
    }
}

function updateToxicClearance(toxic) {
    if (!toxic) return;

    const cleared = toxic.sold_count || 43;
    const remaining = toxic.remaining_count || 84;
    const total = cleared + remaining;
    const pct = (cleared / total * 100).toFixed(1);
    const weeksToGo = toxic.weeks_to_clear || 8;

    // Update numbers
    updateEl('toxic-cleared', cleared);
    updateEl('toxic-remaining', remaining);
    updateEl('legacy-toxic-remaining', remaining);

    // Update progress bar
    const progressEl = document.getElementById('toxic-bar');
    if (progressEl) {
        progressEl.style.width = pct + '%';
    }

    // Calculate clearance rate (cleared over ~4 weeks of Q1 so far)
    const weeksElapsed = 4;
    const rate = Math.round(cleared / weeksElapsed);
    updateEl('clearance-rate', rate);

    // Update projection text
    const projectionEl = document.querySelector('.toxic-clearance__projection');
    if (projectionEl && weeksToGo) {
        const weeksRounded = Math.ceil(weeksToGo);
        const now = new Date();
        const clearDate = new Date(now.getTime() + weeksRounded * 7 * 24 * 60 * 60 * 1000);
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const clearMonth = monthNames[clearDate.getMonth()];
        projectionEl.innerHTML = `Clearing <strong>${rate} homes/week</strong> → Zero by ${weeksRounded <= 4 ? 'late ' : 'early '}${clearMonth}`;
    }
}

function updatePortfolioSections(v3) {
    if (!v3 || !v3.portfolio) return;

    const kaz = v3.portfolio.kaz_era;
    const legacy = v3.portfolio.legacy;

    // Helper to format currency
    const fmtK = (v) => {
        if (v >= 1000000) return '+$' + (v/1000000).toFixed(1) + 'M';
        if (v >= 1000) return '+$' + (v/1000).toFixed(1) + 'K';
        return '+$' + v.toFixed(0);
    };
    const fmtNeg = (v) => '-$' + (Math.abs(v)/1000).toFixed(1) + 'K';

    // === KAZ-ERA SOLD ===
    updateEl('kaz-sold-count', kaz.sold_count);
    updateEl('kaz-sold-wr', kaz.sold_win_rate.toFixed(1) + '%');
    updateEl('kaz-sold-profit', '$' + (kaz.sold_avg_profit/1000).toFixed(1) + 'K');
    updateEl('kaz-sold-total', fmtK(kaz.sold_total_realized));

    // === KAZ-ERA LISTED ===
    updateEl('kaz-listed-count', kaz.listed_count);
    updateEl('kaz-listed-above', kaz.listed_above_water_pct.toFixed(1) + '% (' + kaz.listed_above_water + ')');
    updateEl('kaz-listed-uw', kaz.listed_underwater_pct.toFixed(1) + '% (' + kaz.listed_underwater + ')');
    updateEl('kaz-listed-cuts', kaz.listed_with_cuts_pct.toFixed(1) + '% (' + kaz.listed_with_cuts + ')');

    // === KAZ-ERA EXPOSURE ===
    updateEl('kaz-realized', fmtK(kaz.sold_total_realized));
    updateEl('kaz-unrealized', fmtK(kaz.net_position - kaz.sold_total_realized));
    updateEl('kaz-uw-exposure', fmtNeg(kaz.listed_underwater_exposure));

    // === LEGACY SOLD ===
    updateEl('legacy-sold-count', legacy.sold_count);
    updateEl('legacy-sold-wr', legacy.sold_win_rate.toFixed(1) + '%');
    updateEl('legacy-sold-profit', '$' + (legacy.sold_avg_profit/1000).toFixed(1) + 'K');
    updateEl('legacy-sold-total', fmtK(legacy.sold_total_realized));

    // === LEGACY LISTED ===
    updateEl('legacy-listed-count', legacy.listed_count);
    updateEl('legacy-listed-above', legacy.listed_above_water_pct.toFixed(1) + '% (' + legacy.listed_above_water + ')');
    updateEl('legacy-listed-uw', legacy.listed_underwater_pct.toFixed(1) + '% (' + legacy.listed_underwater + ')');
    updateEl('legacy-listed-cuts', legacy.listed_with_cuts_pct.toFixed(1) + '% (' + legacy.listed_with_cuts + ')');

    // === LEGACY EXPOSURE ===
    updateEl('legacy-uw-exposure', '-$' + (legacy.listed_underwater_exposure/1000000).toFixed(1) + 'M');

    // === UNDERWATER WATCHLIST ===
    if (v3.underwater_watchlist && v3.underwater_watchlist.length > 0) {
        const watchlistBody = document.getElementById('watchlist-body');
        if (watchlistBody) {
            updateEl('uw-count', v3.underwater_watchlist.length);
            const totalExposure = v3.underwater_watchlist.reduce((sum, h) => sum + h.underwater_amount, 0);
            updateEl('uw-total', '-$' + (totalExposure/1000).toFixed(1) + 'K');

            watchlistBody.innerHTML = v3.underwater_watchlist.map(h => {
                const statusClass = h.status === 'Concern' ? 'concern' : 'watching';
                return `<tr>
                    <td class="name">${h.city}, ${h.state}</td>
                    <td>${h.days_on_market}</td>
                    <td class="red">-$${(h.underwater_amount/1000).toFixed(1)}K</td>
                    <td>${h.price_cuts}</td>
                    <td><span class="status-badge ${statusClass}">${h.status}</span></td>
                </tr>`;
            }).join('');
        }
    }
}

function updateEl(id, value) {
    const el = document.getElementById(id);
    if (el && value !== undefined) el.textContent = value;
}

function updateText(selector, value) {
    const el = document.querySelector(selector);
    if (el && value !== undefined) {
        el.textContent = value;
    }
}

document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
